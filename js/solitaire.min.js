"use strict";function Start(bd){K.start(bd);cn(K.bz);$("#stock").on("click",ch);$(options.src).on(options.evt,".card:last-child",cx);$("#game, #again").on("click",cw);$("#hint").on("click",cv);$("#undo").on("click",dz);$("#tool, #list").on("click",cc);$("body").on("contextmenu",cf);$(document).on("keyup",function(n){n.which===113?cw():n.which===72?cv():n.which===90?n.ctrlKey&&dz():(n.which===13||n.which===32)&&K.cp()&&cw()}).on("keydown",function(n){n.which===32&&n.preventDefault()});ck()}function cf(n){var t,bi;return(n.preventDefault(),de(),t=K.bv(),t===null)?!1:(bi=K.ci(t.aa,t.az,t.ae.id),cm(bi),cf(n),!1)}function cg(n){if(options.dad!==""){if(!n){try{try{$(".ui-draggable").draggable("destroy")}catch(i){}try{$(".drop").droppable("destroy")}catch(i){}}catch(r){}$("body").css("cursor","auto");return}var t={containment:"#solitaire",cursor:"move",revert:!0,opacity:1.7,revertDuration:"fast",helper:function(n){var t=$(n.target),af=t.nextAll().addBack(),i=$("<div/>").append(af.clone()).css("margin-top",t.css("margin-top")).css("margin-left",t.css("margin-left"));return af.addClass("hide"),i},start:function(n,t){t.helper.css("z-index",1);var i={hoverClass:"hovered",tolerance:options.mod,drop:function(n,t){cj(n,t.draggable[0].id)}};$(".drop").droppable(i)},stop:function(n,t){t.helper.css("z-index",0);$(".card").removeClass("hide")}};$(options.dad).draggable(t)}}function ch(){K.bc();cn(K.bz);ck()}function cj(n,aa){var az=$("#"+aa).parent().attr("id"),bi=K.ci(aa,az,n.target.id);cm(bi)}function ck(){$(".dialog").hide();cg(!0);da();var cp=K.cp();cp!==0&&($("#win h3").hide(),cp>0&&$("#win .win").show(),cp<0&&$("#win .lost").show(),$("#win").show(),$("#overlay").show(),setTimeout(function(){$("#overlay").hide()},1e3))}function cl(ci){var n=K.cz(ci.az);cn([n]);cn([ci.ae])}function cm(bi){if(bi.length!==0){cg(!1);for(var n=0;n<bi.length;n++)cl(bi[n]);ck()}}function cw(){K.count<10?(K.start(),cn(K.bz),ck()):location.reload()}function cx(n){var aa=n.target.id,az=$("#"+aa).parent().attr("id"),bi=K.ci(aa,az,options.dst);cm(bi)}function cc(){$(".dialog").hide();$("#run").show()}function cv(){var bq;for(de();L.length>0;)clearTimeout(L.pop());if($(".hint").removeClass("hint"),$("#zombie").remove(),bq=K.bn(),bq!==null){var i=500,t=1500,aa=bq.aa,n=bq.ae;n.id==="stock"?(i-=500,t-=500):$("#"+aa).addClass("hint");n.id==="waste"?t-=500:n.ax()?$("#"+n.id).append("<div id='zombie' class='card hint space'>"):(aa=n.al().ap,L.push(setTimeout(function(){$("#"+aa).addClass("hint")},i)));L.push(setTimeout(function(){$(".hint").removeClass("hint");$("#zombie").remove()},t))}}function cn(bz){for(var i,t,ar,n=0;n<bz.length;n++)bz[n]!==null&&($("#"+bz[n].id+" .card").remove(),$("#"+bz[n].id).append(bz[n].ad()));for($(".drag").removeClass("drag"),i=K.bx(),t=0;t<i.length;t++)$("#"+i[t]).addClass("drag");K.bl!==null&&(ar=K.bl===9?"10":E[K.bl][0],$(".drop .write div").text(ar))}function da(){var t=K.bw()?"+":"Ã—",n;$("#stock .write div").text(t);n=K.br.af.length;K.id==="AcesUp"&&(n/=4);n<6&&n>0&&$(".count .card:last-child").html("<div>"+n.toString()+"<\/div>")}function dz(){cm(K.cd())}function de(){K.bk!==null&&(K.bk.ae.al().ao=!1,cn([K.bk.ae]),K.bk=null)}var F=["Hearts","Spades","Diamonds","Clubs"],E=["Ace","2","3","4","5","6","7","8","9","10","Jack","Queen","King"],G=0,H=1,I=2,J=3,A=function(){function A(aa,az,ae){this.aa=aa;this.az=az;this.ae=ae}return A}(),B=function(){function B(n){this.id=n;this.ar=n%13;this.at=Math.floor(n/13);this.ay=this.at===G||this.at===I;this.au=!this.ay;this.ai=!1;this.ao=!1;this.ap=F[this.at][0]+(this.ar===9?"T":E[this.ar][0]);this.html="<div id='"+this.ap+"' class='card down'><\/div>"}return B.prototype.aq=function(){return this.ar===0},B.prototype.as=function(){return this.ar===12},B.prototype.ad=function(){var n=this.html;return this.ao&&(n=n.replace(" down"," down selected")),this.ai&&(n=n.replace(" down"," up")),n},B.prototype.toString=function(){return E[this.ar]+" "+F[this.at]},B}(),C=function(){function C(){this.af=[];for(var n=0;n<52;n++)this.af[n]=new B(n);for(n=0;n<this.af.length;n++)this.af[n]=this.af.splice(Math.floor(this.af.length*Math.random()),1,this.af[n])[0]}return C.prototype.ag=function(n){return n>this.af.length&&(n=this.af.length),this.af.splice(0,n)},C}(),D=function(){function D(ah,n){this.ah=ah;this.af=[];this.id=n;this.aj=-1}return D.prototype.al=function(){return this.af[this.af.length-1]},D.prototype.am=function(aa){for(var n=0;n<this.af.length;n++)if(this.af[n].ap===aa)return n;return-1},D.prototype.aw=function(){for(var n=0;n<this.af.length;n++)if(this.af[n].ai)return n;return-1},D.prototype.ax=function(){return this.af.length===0},D.prototype.ac=function(){return this.id[0]==="f"},D.prototype.av=function(){return this.id[0]==="r"},D.prototype.ab=function(){return this.id[0]==="s"},D.prototype.an=function(){return this.id[0]==="t"},D.prototype.ba=function(){return this.id[0]==="w"},D.prototype.ad=function(){var r="",i=this.aj,n,t;for(i<0&&(i=this.af.length),n=this.af.length-i,n<0&&(n=0),t=n;t<this.af.length;t++)r+=this.af[t].ad();return r},D.prototype.toString=function(){return this.id},D}(),M=function(){function M(){this.bz=[];this.be=[];this.br=null;this.bt=null;this.by=[];this.bu=[];this.bi=[];this.bo=!1;this.bp=null;this.bq=-1;this.bs=!0;this.id="Klondike";this.bd=1;this.count=0;this.bj=!0;this.bk=null;this.bl=null}return M.prototype.bm=function(){var n=new N(this.bz,this.cr,this.ce);n.bd=this.bd;this.bp=n.du();this.bq=-1;this.bs=this.bp.length!==0;this.id==="FreeCell"&&this.be.reduce(function(n,t){return n+t.af.length},0)<4&&(this.bs=!0)},M.prototype.bw=function(){return this.id==="Cruel"||this.id==="MonteCarlo"?!this.bj:this.br&&this.br.af.length>0?!0:this.bt&&this.bt.af.length>0?!0:!1},M.prototype.ag=function(){var t=function(ah){var n=null;switch(ah){case 13:break;case 7:n="stock";break;case 8:n="waste";break;case 9:case 10:case 11:case 12:n="f"+(ah-9).toString();break;default:n="t"+ah.toString()}return n},n;for(this.co(t),n=0;n<this.by.length;n++)this.by[n].af=this.br.af.splice(0,n+1),this.by[n].af[n].ai=!0},M.prototype.bx=function(){for(var ae,t,i=[],n=0;n<this.bz.length;n++)(ae=this.bz[n],ae.ax())||ae.ab()||(t=ae.al().ap,ae.an()&&(t=ae.id+" .up"),i.push(t));return i},M.prototype.bc=function(){if(this.br.id!==""){if(this.br.ax()){if(this.bt&&!this.bt.ax()){for(this.cq("list",null,null);!this.bt.ax();)this.cs(this.bt,this.br);this.cq("list",null,null)}}else{this.bd!==1&&this.cq("list",null,null);for(var n=0;n<this.bd;n++)this.cs(this.br,this.bt||this.bu[0]);this.bd!==1&&this.cq("list",null,null)}this.bj=!0;this.bm()}},M.prototype.bv=function(){var n,bq;for(this.bm(),n=0;n<this.bp.length;n++)if(bq=this.bp[n],bq.aa!=="draw"){if(!bq.ae.ac())if(this.id==="MonteCarlo"){if(bq.az[0]!=="t")continue}else if(this.id==="Pyramid"){if(bq.az[0]!=="t"&&bq.az[0]!=="w")continue}else continue;return bq}return null},M.prototype.bn=function(){return(this.bp===null&&this.bm(),!this.bs)?null:(this.bq++,this.bq===this.bp.length&&(this.bq=0),this.bp[this.bq])},M.prototype.cz=function(n){for(var t=0;t<this.bz.length;t++)if(this.bz[t].id===n)return this.bz[t];return null},M.prototype.ce=function(n,t,i,bu,r){var u=t.af[n],f,e;if(!r&&n!==t.af.length-1)return null;if(u.aq()&&i.ax())return i;for(f=0;f<this.bu.length;f++){if(i=bu[f],i.ax()){if(u.aq())return i;continue}if(e=i.al(),u.at===e.at&&u.ar===e.ar+1)return i}return null},M.prototype.cr=function(n,t,i){var r=t.af[n],u;if(t.ah===i.ah)return null;if(i.ax()){if(!r.as())return null}else if((u=i.al(),r.ay===u.ay)||r.ar!==u.ar-1)return null;return i},M.prototype.ct=function(){return(this.bp=null,this.bn()===null)?!0:(this.bq=-1,this.bp.length>1,!1)},M.prototype.cu=function(){var n,t;if(this.bd!==1&&(this.br.af.length>0||this.bt.af.length>1))return!1;for(n=0;n<this.by.length;n++)for(t=0;t<this.by[n].af.length;t++)if(this.by[n].af[t].ai===!1)return!1;return!0},M.prototype.ci=function(aa,az,n){var i=this.cz(az),t=this.cz(n),e=i.am(aa),af,u,f,r,bi;if(this.bo||(t=t.an()?this.cr(e,i,t):t.ac()?this.ce(e,i,t,this.bu):null),!t)return[];for(af=i.af.splice(e),u=0;u<af.length;u++)t.af.push(af[u]);return f=null,this.bo||(r=i.al(),r&&!r.ai&&(r.ai=!0,f=r.ap)),bi=[this.cq(aa,az,t)],f&&bi.push(this.cq(f,az,null)),bi},M.prototype.co=function(n){for(var r=new C,i,t=0;t<99;t++){if(i=n(t),i===null)break;this.bz[t]=new D(t,i)}for(this.by=[],this.bu=[],this.be=[],t=0;t<this.bz.length;t++)switch(this.bz[t].id[0]){case"r":this.be.push(this.bz[t]);break;case"s":this.br=this.bz[t];break;case"w":this.bt=this.bz[t];this.bt.aj=3;break;case"t":this.by.push(this.bz[t]);break;case"f":this.bu.push(this.bz[t])}this.br||(this.br=new D(99,""));this.br.af=r.ag(99);this.bi=[];this.bp=null},M.prototype.start=function(bd){bd&&(this.bd=bd);for(var cp=-1;cp===-1;)this.ag(),this.bc(),cp=this.cp();this.count++},M.prototype.cp=function(){return this.cu()?1:0},M.prototype.cq=function(aa,az,ae){this.bp=null;var ci=new A(aa,az,ae);return this.bo||this.bi.push(ci),ci},M.prototype.cs=function(n,t){if(!n.ax()){var i=n.af.pop();t.af.push(i);this.cq(i.ap,n.id,t);i.ai=n.ab();this.cq(i.ap,t.id,null)}},M.prototype.cd=function(){var n,t,i,r,u,bi;if(this.bi.length===0)return[];n=this.bi[this.bi.length-1];t=0;n.aa==="list"?(t=99999,n=this.bi.pop()):t=n.ae===null?2:1;i=[];this.bo=!0;do n=this.bi.pop(),n.aa==="list"?t=0:n.ae===null?(r=this.cz(n.az),u=r.am(n.aa),r.af[u].ai=!r.af[u].ai,i.push(n)):(bi=this.ci(n.aa,n.ae.id,n.az),i.push(bi[0])),t--;while(t>0);return this.bo=!1,i},M}(),K=new M,L=[],options={evt:"dblclick",src:"#tableaux, #waste",dst:"f0",dad:".drag",mod:"pointer"},N=function(){function N(bz,n,t){this.bz=bz;this.cr=n;this.ce=t;this.bp=[];this.br=this.bz[7];this.bt=this.bz[8];this.bu=[];for(var i=0;i<4;i++)this.bu[i]=this.bz[9+i];this.dr=[];this.dt=!1;this.dy=!1;this.bd=1}return N.prototype.du=function(){return this.di(),this.dq(),this.ds(),this.dd(),this.df(),this.dg(),this.dh(),this.dj(),this.dk(),this.bp},N.prototype.di=function(){for(var t,aw,n=0;n<7;n++)t=this.bz[n].af.length,aw=this.bz[n].aw(),this.dr[n]={ah:n,count:t,aw:aw},t===0&&(this.dt=!0),aw>0&&this.bz[n].af[aw].as()&&(this.dy=!0);this.bt.ax()||this.bt.al().as()&&(this.dy=!0);this.dr.sort(function(n,t){return t.aw-n.aw})},N.prototype.do=function(n,t,i){var f=n.af[t],u,r;if(i||!(f.ar<2))for(u=0;u<7;u++)r=this.bz[u],r=this.cr(t,n,r),r&&this.bp.push(new A(f.ap,n.id,r))},N.prototype.dp=function(n,t,i){var u=n.af[t],r;!i&&u.ar<2||(r=this.bu[0],r=this.ce(t,n,r,this.bu),r&&this.bp.push(new A(u.ap,n.id,r)))},N.prototype.dq=function(){for(var t,i,r,n=0;n<7;n++)this.dr[n].count>0&&(t=this.bz[this.dr[n].ah].al(),(t.aq()||t.ar===1)&&(i=this.bz[this.dr[n].ah],r=i.af.length-1,this.dp(i,r,!0),!t.aq()&&r>0&&(t=i.af[r-1],t.ai||this.do(i,r,!0))))},N.prototype.ds=function(){for(var t,i,n=0;n<7;n++)this.dr[n].aw>0&&(t=this.bz[this.dr[n].ah],i=this.dr[n].aw,this.do(t,i))},N.prototype.dd=function(){var n,t,i;if(this.dy&&!this.dt)for(n=0;n<7;n++)this.dr[n].aw===0&&(t=this.bz[this.dr[n].ah],i=0,this.dp(t,i),this.do(t,i,!0))},N.prototype.df=function(){for(var t,i,n=0;n<7;n++)this.dr[n].count>0&&this.dr[n].aw===this.dr[n].count-1&&(t=this.bz[this.dr[n].ah],i=t.af.length-1,this.dp(t,i))},N.prototype.dg=function(){for(var e,u,f,i,s,r=0;r<4;r++)if(!this.bu[r].ax()){if(e=this.bu[r].al(),e.as())continue;var o=e.id+1,h=o<10?"c0"+o.toString():"c"+o.toString(),n=null,t=-1;for(u=0;u<7;u++)if(n=this.bz[u],t=n.am(h),t!==-1)break;if(t===-1)continue;if(t===n.af.length-1)continue;if(f=n.af[t],f.ai===!1)continue;for(i=0;i<7;i++)if(i!==n.ah&&!this.bz[i].ax()&&(s=this.bz[i].al(),s.ay===f.ay&&s.ar===f.ar)){this.do(n,t+1);break}}},N.prototype.dh=function(){var n,t,i;this.bt.ax()||(n=this.bt,t=n.af.length-1,this.dp(n,t,!0),i=n.af[t],i.ar!==0)&&(i.ar!==1||this.bd!==1)&&this.do(n,t,!0)},N.prototype.dj=function(){for(var t,i,n=0;n<7;n++)this.dr[n].count>0&&(t=this.bz[this.dr[n].ah],i=t.af.length-1,this.dp(t,i))},N.prototype.dk=function(){this.br.ax()?this.bt.ax()||this.bp.push(new A(this.bt.al().ap,this.bt.id,this.br)):this.bp.push(new A(this.br.al().ap,this.br.id,this.bt))},N}()